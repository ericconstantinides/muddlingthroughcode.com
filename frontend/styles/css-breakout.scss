$root-pixels: 18px;
$site-width: 980px;
$site-padding: 0.5em;
$skinny-width: 700px;
$skinny-padding: 2em;


@function convert-to-pixels($value, $label) {
  @if unit($value) == "px" {
    @return $value;
  }
  @if global-variable-exists('root-pixels') {
    @if unit($value) == "rem" {
      @return $value / 1rem * $root-pixels;
    } @else if unit($value) == "em" {
      @return $value / 1em * $root-pixels;
    } @else {
      @error $label must be either em, rem, or px;
    }
  } @else {
    @error "$root-pixels must be set";
  }
}

// sanitize our variables and convert to px if necessary
$px-site-width: convert-to-pixels($site-width, '$site-width');
$px-skinny-width: convert-to-pixels($skinny-width, '$skinny-width');
$px-skinny-padding: convert-to-pixels($skinny-padding, '$skinny-padding') * 2;
$px-skinny-width-with-padding: $px-skinny-width + $px-skinny-padding;
$neg-skinny-padding: $skinny-padding * -1;
$site-padding-2x: $site-padding * 2;
$skinny-padding-2x: $skinny-padding * 2;

.site-container {
  width: calc(100% - #{$site-padding-2x});
  max-width: $px-site-width;
  margin-left: auto;
  margin-right: auto;
}
.skinny-container {
  width: calc(100% - #{$skinny-padding-2x});
  max-width: $px-skinny-width;
  margin-left: auto;
  margin-right: auto;
}

.skinny-container .css-breakout--to-skinny-container,
.skinny-container .css-breakout--to-site-container,
.skinny-container .css-breakout--to-max {
  max-width: none;
  width: 100vw;
}

// - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// css-breakout--to-skinny-container
// Only "breaks out" on smaller viewports
// - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.skinny-container .css-breakout--to-skinny-container {
  // Skinny and up to the skinny-container
  @media only screen and (max-width: $px-skinny-width) {
    margin-left: $neg-skinny-padding;
  }
  // tweener period between where the body container loses all of its padding
  @media only screen and (min-width: $px-skinny-width + 1px ) and (max-width: $px-skinny-width-with-padding) {
    width: $px-skinny-width;
    margin-left: calc(50vw - #{$px-skinny-width-with-padding} / 2);
  }
  // from the skinny-container-with-padding and larger
  @media only screen and (min-width: $px-skinny-width-with-padding + 1px) {
    width: 100%;
    margin-left: 0;
  }
}

// - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// css-breakout--to-site-container
// This always extends to the contained width of the site
// - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.skinny-container .css-breakout--to-site-container {
  // skinny and up to the skinny-container-with-padding
  @media only screen and (max-width: $px-skinny-width-with-padding) {
    margin-left: $neg-skinny-padding;
  }
  // tweener between the skinny-container-with-padding to the site-container
  @media only screen and (min-width: $px-skinny-width-with-padding +1px) and (max-width: $site-width) {
    margin-left: calc(-50vw + (#{$px-skinny-width} / 2));
  }
  // from the site-container and larger
  @media only screen and (min-width: $px-site-width + 1px) {
    // this is the outer one:
    width: $px-site-width;
    margin-left: (($px-site-width - $px-skinny-width) / -2);
  }
}

// - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// css-breakout--to-max
// This always extends to the outer edge of the viewport,
// - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.skinny-container .css-breakout--to-max {
  // skinny and up to the skinny-container-with-padding
  @media only screen and (max-width: $px-skinny-width-with-padding) {
    // break out of the skinny-container at the same rate as the padding
    margin-left: $neg-skinny-padding;
  }
  // from the skinny-container-with-padding and larger
  @media only screen and (min-width: $px-skinny-width-with-padding + 1px) {
    // We start with "pulling left" exactly half the viewport.
    // From there we "add back on" half the width of the body, which puts us directly in the center
    margin-left: calc(-50vw + (#{$px-skinny-width} / 2));
  }
}